<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table makeploy_product -->
    <resultMap id="RM-PRODUCT" class="com.onway.makeploy.common.dal.dataobject.ProductDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="shopId" column="SHOP_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="needPeople" column="NEED_PEOPLE"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="nowPeople" column="NOW_PEOPLE"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="productNo" column="PRODUCT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productName" column="PRODUCT_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="templateId" column="TEMPLATE_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productWeight" column="PRODUCT_WEIGHT"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="productType" column="PRODUCT_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="children" column="CHILDREN"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="otherType" column="OTHER_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productOff" column="PRODUCT_OFF"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="price.cent" column="PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="luggage.cent" column="LUGGAGE"  javaType="long" jdbcType="DECIMAL" />
		<result property="usePoint.cent" column="USE_POINT"  javaType="long" jdbcType="DECIMAL" />
		<result property="oldPrice.cent" column="OLD_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="soleCount" column="SOLE_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="checkStatus" column="CHECK_STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="status" column="STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="stock" column="STOCK"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="productUrl" column="PRODUCT_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delFlg" column="DEL_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendFlg" column="RECOMMEND_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="proportionReturn" column="PROPORTION_RETURN"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="proportionIntegral" column="PROPORTION_INTEGRAL"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisProductDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisProductDAO.selectProductByUserId -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-BY-USER-ID" resultMap="RM-PRODUCT">
        SELECT

		    *

			FROM makeploy_product
            WHERE USER_ID = #userId#
            and CHECK_STATUS='1'
            <isNotNull property="startRow">
                limit $startRow$,$pageSize$
            </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductByProNo -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-BY-PRO-NO" resultMap="RM-PRODUCT">
        SELECT
		    *
			FROM makeploy_product
            WHERE PRODUCT_NO = #productNo#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductByShopId -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-BY-SHOP-ID" resultMap="RM-PRODUCT">
        SELECT

		     *

			FROM makeploy_product
            WHERE SHOP_ID = #shopId#
            AND DEL_FLG=0
            AND STATUS=0
            and CHECK_STATUS='1'
            <isNotNull property="startRow">
                limit $startRow$,$pageSize$
            </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectNewProduct -->
    <select id="MS-PRODUCT-SELECT-NEW-PRODUCT" resultMap="RM-PRODUCT">
        SELECT

			*

			FROM makeploy_product
			WHERE DEL_FLG=0
			AND RECOMMEND_FLG=1
			AND STATUS=0
			and CHECK_STATUS='1'
			order by ID desc limit 0,6
    </select>

    <!-- mapped statement for IbatisProductDAO.selectNewProductCount -->
    <select id="MS-PRODUCT-SELECT-NEW-PRODUCT-COUNT" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_product
			WHERE DEL_FLG=0
			AND
			RECOMMEND_FLG=1
			AND STATUS=0
			and CHECK_STATUS='1'
    </select>

    <!-- mapped statement for IbatisProductDAO.selectTmiProduct -->
    <select id="MS-PRODUCT-SELECT-TMI-PRODUCT" resultMap="RM-PRODUCT">
    <![CDATA[
        select * from makeploy_product where ((DEL_FLG = 0) AND (RECOMMEND_FLG = '3') AND (STATUS = 0) AND (CHECK_STATUS = '1'))
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectPartnerProduct -->
    <select id="MS-PRODUCT-SELECT-PARTNER-PRODUCT" resultMap="RM-PRODUCT">
        SELECT
		     ID,
		     SHOP_ID,
		     USER_ID,
		     OTHER_TYPE,
		     PRODUCT_NO,
		     PRODUCT_NAME,
		     PRODUCT_TYPE,
		     PRODUCT_WEIGHT,
		     CHILDREN,
		     PRICE,
		     PRODUCT_OFF,
		     USE_POINT,
		     OLD_PRICE,
		     CHECK_STATUS,
		     TEMPLATE_ID,
		     NEED_PEOPLE,
		     NOW_PEOPLE,
		     LUGGAGE,
		     STATUS,
		     STOCK,
		     PRODUCT_URL,
		     DEL_FLG,
		     RECOMMEND_FLG,
		     SOLE_COUNT,
		     PROPORTION_RETURN,
		     PROPORTION_INTEGRAL,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_product
            WHERE DEL_FLG=0 
            AND STATUS=0
            AND CHECK_STATUS='1'
            <isNotNull property="shopId" prepend="and">
                   SHOP_ID = #shopId#
            </isNotNull>
            order by ID desc
            limit 0,5
    </select>

    <!-- mapped statement for IbatisProductDAO.selectShopCartProduct -->
    <select id="MS-PRODUCT-SELECT-SHOP-CART-PRODUCT" resultMap="RM-PRODUCT">
        SELECT

		     *
			FROM makeploy_product where CHECK_STATUS ='1' and DEL_FLG = '0'
                <isNotNull property="shopId" prepend="and">
                    SHOP_ID = #shopId#
                </isNotNull>
                <isNotNull property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductCountByUserId -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-COUNT-BY-USER-ID" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_product
			WHERE USER_ID = #userId#
			and CHECK_STATUS='1'
    </select>

    <!-- mapped statement for IbatisProductDAO.selectGoodsCountByShopId -->
    <select id="MS-PRODUCT-SELECT-GOODS-COUNT-BY-SHOP-ID" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_product
			WHERE SHOP_ID = #shopId#
			and CHECK_STATUS='1'
			and
			DEL_FLG=0
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductByProductNo -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-BY-PRODUCT-NO" resultMap="RM-PRODUCT">
        SELECT


		   *
			FROM makeploy_product
             WHERE PRODUCT_NO = #productNo# and SHOP_ID=#shopId#
    </select>

    <!-- mapped statement for IbatisProductDAO.deleteProductDelFlg2Zero -->
    <update id="MS-PRODUCT-DELETE-PRODUCT-DEL-FLG-2-ZERO">
    <![CDATA[
        update makeploy_product set DEL_FLG=1, GMT_MODIFIED=CURRENT_TIMESTAMP where ((USER_ID = #userId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.changeProductSellCount -->
    <update id="MS-PRODUCT-CHANGE-PRODUCT-SELL-COUNT">
    <![CDATA[
        update makeploy_product set SOLE_COUNT=#soleCount#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.OffTheShelfProduct -->
    <update id="MS-PRODUCT-OFF-THE-SHELF-PRODUCT">
    <![CDATA[
        update makeploy_product set STATUS=#status#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((USER_ID = #userId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProductCount -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-COUNT">
        UPDATE makeploy_product
            SET STOCK = #stock# ,GMT_MODIFIED = CURRENT_TIMESTAMP
            WHERE USER_ID = #userId# and PRODUCT_NO = #productNo#
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProductPrice -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-PRICE">
    <![CDATA[
        update makeploy_product set PRICE=#price.cent#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (USER_ID = #userId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.selectShop -->
    <select id="MS-PRODUCT-SELECT-SHOP" resultClass="com.onway.makeploy.common.dal.dataobject.ShopShow">
        select 
    			s.SHOP_NAME shopName,
    			p.SHOP_ID shopId
    			from 
    			makeploy_product p,makeploy_shop s
    			where p.SHOP_ID = s.SHOP_ID and p.DEL_FLG = #delflg# group by p.SHOP_ID
    </select>

    <!-- mapped statement for IbatisProductDAO.selectAllProduct -->
    <select id="MS-PRODUCT-SELECT-ALL-PRODUCT" resultMap="RM-PRODUCT">
        select * from makeploy_product where DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="productType" prepend="and">
	                PRODUCT_TYPE = #productType#
	            </isNotEmpty>   
				limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectAllProductOrderByPrice -->
    <select id="MS-PRODUCT-SELECT-ALL-PRODUCT-ORDER-BY-PRICE" resultMap="RM-PRODUCT">
        select * from makeploy_product where DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="productType" prepend="and">
	                PRODUCT_TYPE = #productType#
	            </isNotEmpty>   
				 order By PRICE
				 limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectAllProductOrderByPriceDesc -->
    <select id="MS-PRODUCT-SELECT-ALL-PRODUCT-ORDER-BY-PRICE-DESC" resultMap="RM-PRODUCT">
        select * from makeploy_product where DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="productType" prepend="and">
	                PRODUCT_TYPE = #productType#
	            </isNotEmpty>   
				 order By PRICE desc
				 limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectAllProductCount -->
    <select id="MS-PRODUCT-SELECT-ALL-PRODUCT-COUNT" resultClass="long">
        select count(1) from makeploy_product where DEL_FLG = '0' and CHECK_STATUS='1'
			<isNotEmpty property="productType" prepend="and">
	                PRODUCT_TYPE = #productType#
	        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectproductByType -->
    <select id="MS-PRODUCT-SELECTPRODUCT-BY-TYPE" resultMap="RM-PRODUCT">
        select * from makeploy_product where  DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="productType" prepend="and">
	                PRODUCT_TYPE = #productType#
	            </isNotEmpty>   
				limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectChildrenByType -->
    <select id="MS-PRODUCT-SELECT-CHILDREN-BY-TYPE" resultMap="RM-PRODUCT">
        select * from makeploy_product where  DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="children" prepend="and">
	                CHILDREN = #children#
	            </isNotEmpty>   
				limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectproductByTypeOrderByPrice -->
    <select id="MS-PRODUCT-SELECTPRODUCT-BY-TYPE-ORDER-BY-PRICE" resultMap="RM-PRODUCT">
        select * from makeploy_product where  DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="children" prepend="and">
	                CHILDREN = #children#
	            </isNotEmpty>   
				order by PRICE
				limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectproductByTypeOrderByPriceDesc -->
    <select id="MS-PRODUCT-SELECTPRODUCT-BY-TYPE-ORDER-BY-PRICE-DESC" resultMap="RM-PRODUCT">
        select * from makeploy_product where  DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="children" prepend="and">
	                CHILDREN = #children#
	            </isNotEmpty>   
				order by PRICE desc
				limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectproductCountByType -->
    <select id="MS-PRODUCT-SELECTPRODUCT-COUNT-BY-TYPE" resultClass="long">
        select count(1) from makeploy_product where  DEL_FLG = '0' and CHECK_STATUS='1'
				<isNotEmpty property="children" prepend="and">
	                CHILDREN = #children#
	            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectTeamGoProduct -->
    <select id="MS-PRODUCT-SELECT-TEAM-GO-PRODUCT" resultMap="RM-PRODUCT">
        SELECT

			*

			FROM makeploy_product
			WHERE DEL_FLG=0
			and
			RECOMMEND_FLG='4'
			and STATUS=0
			and CHECK_STATUS='1'
			order by ID desc
			limit 0,3
    </select>

    <!-- mapped statement for IbatisProductDAO.selectTeamGo -->
    <select id="MS-PRODUCT-SELECT-TEAM-GO" resultMap="RM-PRODUCT">
        SELECT

		     *

			FROM makeploy_product
            WHERE DEL_FLG=0 
            and RECOMMEND_FLG='4'
            and STATUS=0
            and CHECK_STATUS='1'
            <isNotNull property="startRow">
                limit $startRow$,$pageSize$
            </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectTeamGoProductCount -->
    <select id="MS-PRODUCT-SELECT-TEAM-GO-PRODUCT-COUNT" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_product
			WHERE DEL_FLG=0
			and
			RECOMMEND_FLG=4
			and STATUS=0
			and CHECK_STATUS='1'
    </select>

    <!-- mapped statement for IbatisProductDAO.search -->
    <select id="MS-PRODUCT-SEARCH" resultMap="RM-PRODUCT">
        select * from makeploy_product where PRODUCT_NAME LIKE #productName#
				and CHECK_STATUS='1'
				and STATUS=0
			    and DEL_FLG=0
				<isNotNull property="startRow">
                limit $startRow$,$pageSize$
                </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.updateStockByProductNo -->
    <update id="MS-PRODUCT-UPDATE-STOCK-BY-PRODUCT-NO">
    <![CDATA[
        update makeploy_product set STOCK=#stock#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((PRODUCT_NO = #productNo#) AND (SHOP_ID = #shopId#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateNowPeopleByProNoAndShopId -->
    <update id="MS-PRODUCT-UPDATE-NOW-PEOPLE-BY-PRO-NO-AND-SHOP-ID">
    <![CDATA[
        update makeploy_product set NOW_PEOPLE=#nowPeople#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((PRODUCT_NO = #productNo#) AND (SHOP_ID = #shopId#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.searchLikeDesc -->
    <select id="MS-PRODUCT-SEARCH-LIKE-DESC" resultMap="RM-PRODUCT">
        SELECT
		    *
			FROM makeploy_product
            WHERE SHOP_ID = #shopId#
            AND DEL_FLG='0'
            <isNotNull prepend="and" property="productName" >
          			PRODUCT_NAME = #productName# 
 			</isNotNull>
            <isNotNull prepend="and" property="productType" >
          			PRODUCT_TYPE = #productType# 
 			</isNotNull>
            <isNotNull prepend="and" property="children" >
          			CHILDREN = #children# 
 			</isNotNull>
            <isNotNull prepend="and" property="productNo" >
          			PRODUCT_NO = #productNo# 
 			</isNotNull>
 			
            <isNotNull prepend="and" property="status" >
          			STATUS = #status# 
 			</isNotNull>
            <isNotNull prepend="and" property="checkStatus" >
          			CHECK_STATUS = #checkStatus# 
 			</isNotNull>
 			
 			 <isNotNull prepend="and" property="priceMin" >
          			<![CDATA[
						PRICE >= #priceMin#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="priceMax" >
          			<![CDATA[
						PRICE <= #priceMax#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
 			
                limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.searchLikeAsc -->
    <select id="MS-PRODUCT-SEARCH-LIKE-ASC" resultMap="RM-PRODUCT">
        SELECT
		    count(1)
			FROM makeploy_product
            WHERE SHOP_ID = #shopId#
            AND DEL_FLG='0'
            <isNotNull prepend="and" property="productName" >
          			PRODUCT_NAME = #productName# 
 			</isNotNull>
            <isNotNull prepend="and" property="productType" >
          			PRODUCT_TYPE = #productType# 
 			</isNotNull>
            <isNotNull prepend="and" property="children" >
          			CHILDREN = #children# 
 			</isNotNull>
            <isNotNull prepend="and" property="productNo" >
          			PRODUCT_NO = #productNo# 
 			</isNotNull>
 			
            <isNotNull prepend="and" property="status" >
          			STATUS = #status# 
 			</isNotNull>
            <isNotNull prepend="and" property="checkStatus" >
          			CHECK_STATUS = #checkStatus# 
 			</isNotNull>
 			
 			 <isNotNull prepend="and" property="priceMin" >
          			<![CDATA[
						PRICE >= #priceMin#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="priceMax" >
          			<![CDATA[
						PRICE <= #priceMax#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.insert -->
    <insert id="MS-PRODUCT-INSERT">
    <![CDATA[
        insert into makeploy_product(SHOP_ID,USER_ID,OTHER_TYPE,PRODUCT_NO,PRODUCT_NAME,PRODUCT_TYPE,PRODUCT_WEIGHT,CHILDREN,PRODUCT_OFF,PRICE,LUGGAGE,TEMPLATE_ID,USE_POINT,OLD_PRICE,CHECK_STATUS,STATUS,STOCK,PRODUCT_URL,DEL_FLG,PROPORTION_RETURN,PROPORTION_INTEGRAL,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#shopId#, #userId#, #otherType#, #productNo#, #productName#, #productType#, #productWeight#, #children#, #productOff#, #price.cent#, #luggage.cent#, #templateId#, #usePoint.cent#, #oldPrice.cent#, #checkStatus#, #status#, #stock#, #productUrl#, #delFlg#, #proportionReturn#, #proportionIntegral#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisProductDAO.updateProductInfo -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-INFO">
    <![CDATA[
        update makeploy_product set PRODUCT_NAME=#productName#, PRODUCT_TYPE=#productType#, CHILDREN=#children#, PRODUCT_OFF=#productOff#, PRICE=#price.cent#, LUGGAGE=#luggage.cent#, OLD_PRICE=#oldPrice.cent#, STOCK=#stock#, PRODUCT_URL=#productUrl#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.editProductInfo -->
    <update id="MS-PRODUCT-EDIT-PRODUCT-INFO">
    <![CDATA[
        update makeploy_product set PRODUCT_NAME=#productName#, PRODUCT_TYPE=#productType#, CHILDREN=#children#, PRICE=#price.cent#, OLD_PRICE=#oldPrice.cent#, LUGGAGE=#luggage.cent#, STOCK=#stock#, PRODUCT_URL=#productUrl#, MEMO=#memo#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.editProduct -->
    <update id="MS-PRODUCT-EDIT-PRODUCT">
    <![CDATA[
        update makeploy_product set PRODUCT_NAME=#productName#, PRODUCT_TYPE=#productType#, CHILDREN=#children#, PRICE=#price.cent#, OLD_PRICE=#oldPrice.cent#, TEMPLATE_ID=#templateId#, STOCK=#stock#, PRODUCT_URL=#productUrl#, PRODUCT_WEIGHT=#productWeight#, USE_POINT=#usePoint.cent#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProductUpDownSTATUS -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-UP-DOWN-STATUS">
    <![CDATA[
        update makeploy_product set STATUS=#status#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProductUpDownSTATUSByProNo -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-UP-DOWN-STATUS-BY-PRO-NO">
    <![CDATA[
        update makeploy_product set STATUS=#status#, GMT_MODIFIED=CURRENT_TIMESTAMP where (PRODUCT_NO = #productNo#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProductDelflag -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-DELFLAG">
    <![CDATA[
        update makeploy_product set DEL_FLG=#delFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.searchLikeAll -->
    <select id="MS-PRODUCT-SEARCH-LIKE-ALL" resultMap="RM-PRODUCT">
        select * from makeploy_product where PRODUCT_NAME LIKE #productName#
				and CHECK_STATUS='1'
				and STATUS=0
			    and DEL_FLG=0 
				<isNotEmpty property="startRow">
                limit $startRow$,$pageSize$
                </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.searchLikeCount -->
    <select id="MS-PRODUCT-SEARCH-LIKE-COUNT" resultClass="long">
        select count(1) from makeploy_product where PRODUCT_NAME LIKE #productName#
				and CHECK_STATUS='1'
				and STATUS=0
			    and DEL_FLG=0
    </select>

    <!-- mapped statement for IbatisProductDAO.updateRecommendFlgByShopIdAndProductNo -->
    <update id="MS-PRODUCT-UPDATE-RECOMMEND-FLG-BY-SHOP-ID-AND-PRODUCT-NO">
    <![CDATA[
        update makeploy_product set RECOMMEND_FLG=#recommendFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.countRecommendFlg -->
    <select id="MS-PRODUCT-COUNT-RECOMMEND-FLG" resultClass="long">
        select count(1) from makeploy_product 
   			 where 
   			 CHECK_STATUS='1' and 
   			 STATUS='0' and STOCK>0 
   			 and DEL_FLG='0'
   		<isNotEmpty property="flg" prepend="and">
			RECOMMEND_FLG=#flg#
        </isNotEmpty> 
    	<isNotEmpty property="shopId" prepend="and">
			SHOP_ID=#shopId#
        </isNotEmpty> 
        <isNotEmpty property="productNo" prepend="and">
			PRODUCT_NO=#productNo#
        </isNotEmpty> 
        <isNotEmpty property="proName" prepend="and">
			PRODUCT_NAME LIKE #proName#
        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectByRecommendFlg -->
    <select id="MS-PRODUCT-SELECT-BY-RECOMMEND-FLG" resultMap="RM-PRODUCT">
        select * from makeploy_product
    	where CHECK_STATUS='1' and STATUS='0' and STOCK>0 and DEL_FLG='0' 
    	<isNotEmpty property="shopId" prepend="and">
			SHOP_ID=#shopId#
        </isNotEmpty> 
        <isNotEmpty property="productNo" prepend="and">
			PRODUCT_NO=#productNo#
        </isNotEmpty> 
        <isNotEmpty property="rflg" prepend="and">
			RECOMMEND_FLG=#rflg#
        </isNotEmpty> 
        <isNotEmpty property="proName" prepend="and">
			PRODUCT_NAME LIKE #proName#
        </isNotEmpty>
        order by RECOMMEND_FLG 
    	limit #offent#,#limit#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectProductByShopIdSearchBox -->
    <select id="MS-PRODUCT-SELECT-PRODUCT-BY-SHOP-ID-SEARCH-BOX" resultMap="RM-PRODUCT">
        SELECT
		    *
			FROM makeploy_product
            WHERE SHOP_ID = #shopId#
            AND DEL_FLG='0'
            <isNotNull prepend="and" property="productName" >
          			PRODUCT_NAME like '%$productName$%' 
 			</isNotNull>
            <isNotNull prepend="and" property="productType" >
          			PRODUCT_TYPE = #productType# 
 			</isNotNull>
            <isNotNull prepend="and" property="children" >
          			CHILDREN = #children# 
 			</isNotNull>
            <isNotNull prepend="and" property="productNo" >
          			PRODUCT_NO = #productNo# 
 			</isNotNull>
 			
            <isNotNull prepend="and" property="status" >
          			STATUS = #status# 
 			</isNotNull>
            <isNotNull prepend="and" property="checkStatus" >
          			CHECK_STATUS = #checkStatus# 
 			</isNotNull>
 			
 			<isNotNull prepend="and" property="recommendFlg" >
          			RECOMMEND_FLG = #recommendFlg# 
 			</isNotNull>
 			 <isNotNull prepend="and" property="priceMin" >
          			<![CDATA[
						PRICE >= #priceMin#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="priceMax" >
          			<![CDATA[
						PRICE <= #priceMax#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
 			
                limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectCountProductByShopIdSearchBox -->
    <select id="MS-PRODUCT-SELECT-COUNT-PRODUCT-BY-SHOP-ID-SEARCH-BOX" resultClass="int">
        SELECT
		    count(1)
			FROM makeploy_product
            WHERE SHOP_ID = #shopId#
            AND DEL_FLG='0'
            <isNotNull prepend="and" property="productName" >
          			PRODUCT_NAME like '%$productName$%' 
 			</isNotNull>
            <isNotNull prepend="and" property="productType" >
          			PRODUCT_TYPE = #productType# 
 			</isNotNull>
            <isNotNull prepend="and" property="children" >
          			CHILDREN = #children# 
 			</isNotNull>
            <isNotNull prepend="and" property="productNo" >
          			PRODUCT_NO = #productNo# 
 			</isNotNull>
 			
            <isNotNull prepend="and" property="status" >
          			STATUS = #status# 
 			</isNotNull>
            <isNotNull prepend="and" property="checkStatus" >
          			CHECK_STATUS = #checkStatus# 
 			</isNotNull>
 			
 			<isNotNull prepend="and" property="recommendFlg" >
          			RECOMMEND_FLG = #recommendFlg# 
 			</isNotNull>
 			 <isNotNull prepend="and" property="priceMin" >
          			<![CDATA[
						PRICE >= #priceMin#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="priceMax" >
          			<![CDATA[
						PRICE <= #priceMax#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.selectUncheckProduct -->
    <select id="MS-PRODUCT-SELECT-UNCHECK-PRODUCT" resultMap="RM-PRODUCT">
        select
			* from makeploy_product
            WHERE DEL_FLG='0'
            and CHECK_STATUS='0'
             <isNotNull prepend="and" property="shopId" >
          			SHOP_ID = #shopId# 
 			</isNotNull>
 			 <isNotNull prepend="and" property="productNo" >
          			PRODUCT_NO = #productNo# 
 			</isNotNull>
            limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisProductDAO.selectCountUncheckProduct -->
    <select id="MS-PRODUCT-SELECT-COUNT-UNCHECK-PRODUCT" resultClass="int">
        select count(1) from makeploy_product
         WHERE DEL_FLG='0'
         and CHECK_STATUS='0'
         <isNotNull prepend="and" property="shopId" >
          		SHOP_ID = #shopId# 
 		 </isNotNull>
 		 <isNotNull prepend="and" property="productNo" >
          		PRODUCT_NO = #productNo# 
 		 </isNotNull>
    </select>

    <!-- mapped statement for IbatisProductDAO.updateProductCheck -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT-CHECK">
    <![CDATA[
        update makeploy_product set CHECK_STATUS=#checkStatus#, STATUS=#status#, PROPORTION_RETURN=#proportionReturn#, PROPORTION_INTEGRAL=#proportionIntegral#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((PRODUCT_NO = #productNo#) AND (SHOP_ID = #shopId#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateNeedpeople -->
    <update id="MS-PRODUCT-UPDATE-NEEDPEOPLE">
    <![CDATA[
        update makeploy_product set NEED_PEOPLE=#needPeople#, PRICE=#price.cent#, PRODUCT_OFF=#productOff#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.searchShopId -->
    <select id="MS-PRODUCT-SEARCH-SHOP-ID" resultMap="RM-PRODUCT">
        select * from makeploy_product
    	where 1=1
    	<isNotEmpty property="userId" prepend="and">
			USER_ID=#userId#
        </isNotEmpty> 
        limit 0,3
    </select>

    <!-- mapped statement for IbatisProductDAO.updateProduct -->
    <update id="MS-PRODUCT-UPDATE-PRODUCT">
    <![CDATA[
        update makeploy_product set PRODUCT_NO=#productNo#, PRODUCT_NAME=#productName#, PRODUCT_TYPE=#productType#, PRICE=#price.cent#, PRODUCT_OFF=#productOff#, OLD_PRICE=#oldPrice.cent#, LUGGAGE=#luggage.cent#, RECOMMEND_FLG=#recommendFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.searchProductInfo -->
    <select id="MS-PRODUCT-SEARCH-PRODUCT-INFO" resultMap="RM-PRODUCT">
        select * from makeploy_product
    	where 1=1
    	<isNotEmpty property="userId" prepend="and">
			USER_ID=#userId#
        </isNotEmpty> 
         limit #offset#,#limit#
    </select>

    <!-- mapped statement for IbatisProductDAO.searchParenter -->
    <select id="MS-PRODUCT-SEARCH-PARENTER" resultMap="RM-PRODUCT">
    <![CDATA[
        select * from makeploy_product where (RECOMMEND_FLG = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.total -->
    <select id="MS-PRODUCT-TOTAL" resultClass="long">
    <![CDATA[
        select count(1) from makeploy_product
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.updateStatus -->
    <update id="MS-PRODUCT-UPDATE-STATUS">
    <![CDATA[
        update makeploy_product set RECOMMEND_FLG=#recommendFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((PRODUCT_NO = #productNo#) AND (SHOP_ID = #shopId#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.selectByShopIdSearch -->
    <select id="MS-PRODUCT-SELECT-BY-SHOP-ID-SEARCH" resultMap="RM-PRODUCT">
    <![CDATA[
        select * from makeploy_product where (PRODUCT_NO = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisProductDAO.addPartnerPro -->
    <insert id="MS-PRODUCT-ADD-PARTNER-PRO">
    <![CDATA[
        insert into makeploy_product(SHOP_ID,USER_ID,OTHER_TYPE,PRODUCT_NO,PRODUCT_NAME,PRODUCT_TYPE,PRODUCT_WEIGHT,CHILDREN,PRICE,PRODUCT_OFF,TEMPLATE_ID,OLD_PRICE,CHECK_STATUS,NEED_PEOPLE,NOW_PEOPLE,LUGGAGE,STATUS,STOCK,PRODUCT_URL,DEL_FLG,RECOMMEND_FLG,SOLE_COUNT,PROPORTION_RETURN,PROPORTION_INTEGRAL,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#shopId#, #userId#, #otherType#, #productNo#, #productName#, #productType#, #productWeight#, #children#, #price.cent#, #productOff#, #templateId#, #oldPrice.cent#, #checkStatus#, #needPeople#, #nowPeople#, #luggage.cent#, #status#, #stock#, #productUrl#, #delFlg#, #recommendFlg#, #soleCount#, #proportionReturn#, #proportionIntegral#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisProductDAO.selectShopProInfo -->
    <select id="MS-PRODUCT-SELECT-SHOP-PRO-INFO" resultMap="RM-PRODUCT">
        select * from makeploy_product
		WHERE CHECK_STATUS=1 AND STATUS=0 and DEL_FLG=0 
		<isNotEmpty property="shopId" prepend="and">
			SHOP_ID=#shopId#
        </isNotEmpty> 
		<isNotEmpty property="proNo" prepend="and">
			PRODUCT_NO=#proNo#
        </isNotEmpty> 
    	<isNotEmpty property="proName" prepend="and">
			PRODUCT_NAME LIKE '%$proName$%'
        </isNotEmpty> 
        <isNotEmpty property="fatherType" prepend="and">
			PRODUCT_TYPE=#fatherType#
        </isNotEmpty> 
        <isNotEmpty property="childrenType" prepend="and">
			CHILDREN=#childrenType#
        </isNotEmpty> 
         limit #offset#,#limit#
    </select>

    <!-- mapped statement for IbatisProductDAO.proInfoCount -->
    <select id="MS-PRODUCT-PRO-INFO-COUNT" resultClass="long">
        select count(1) from makeploy_product
		WHERE CHECK_STATUS=1 AND STATUS=0 and DEL_FLG=0 
		<isNotEmpty property="shopId" prepend="and">
			SHOP_ID=#shopId#
        </isNotEmpty> 
		<isNotEmpty property="proNo" prepend="and">
			PRODUCT_NO=#proNo#
        </isNotEmpty> 
    	<isNotEmpty property="proName" prepend="and">
			PRODUCT_NAME LIKE '%$proName$%'
        </isNotEmpty> 
        <isNotEmpty property="fatherType" prepend="and">
			PRODUCT_TYPE=#fatherType#
        </isNotEmpty> 
        <isNotEmpty property="childrenType" prepend="and">
			CHILDREN=#childrenType#
        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisProductDAO.updateProPromotionTeamGo -->
    <update id="MS-PRODUCT-UPDATE-PRO-PROMOTION-TEAM-GO">
    <![CDATA[
        update makeploy_product set PRICE=#price.cent#, NEED_PEOPLE=#needPeople#, RECOMMEND_FLG=#recommendFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.updateProPromotionFirstTime -->
    <update id="MS-PRODUCT-UPDATE-PRO-PROMOTION-FIRST-TIME">
    <![CDATA[
        update makeploy_product set PRICE=#price.cent#, RECOMMEND_FLG=#recommendFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((SHOP_ID = #shopId#) AND (PRODUCT_NO = #productNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisProductDAO.downProductOrderByShop -->
    <update id="MS-PRODUCT-DOWN-PRODUCT-ORDER-BY-SHOP">
    <![CDATA[
        update makeploy_product set STATUS=#status#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

</sqlMap>
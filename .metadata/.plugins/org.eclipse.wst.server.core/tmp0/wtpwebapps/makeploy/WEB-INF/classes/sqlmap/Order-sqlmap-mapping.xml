<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table makeploy_order -->
    <resultMap id="RM-ORDER" class="com.onway.makeploy.common.dal.dataobject.OrderDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="userName" column="USER_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="addressNo" column="ADDRESS_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderNo" column="ORDER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderId" column="ORDER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderNum" column="ORDER_NUM"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="cell" column="CELL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="payNo" column="PAY_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="parflag" column="PARFLAG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="transportNo" column="TRANSPORT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productNo" column="PRODUCT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="eachproCount" column="EACHPRO_COUNT"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="productCount" column="PRODUCT_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="eachproPrice.cent" column="EACHPRO_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="point.cent" column="POINT"  javaType="long" jdbcType="DECIMAL" />
		<result property="shopId" column="SHOP_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderPrice.cent" column="ORDER_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="payStatus" column="PAY_STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sendGoods" column="SEND_GOODS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="payTime" column="PAY_TIME"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="payWay" column="PAY_WAY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderType" column="ORDER_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderStatus" column="ORDER_STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="luggage.cent" column="LUGGAGE"  javaType="long" jdbcType="DECIMAL" />
		<result property="delflag" column="DELFLAG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="expectedReturn.cent" column="EXPECTED_RETURN"  javaType="long" jdbcType="DECIMAL" />
		<result property="expectedIntegral" column="EXPECTED_INTEGRAL"  javaType="long" jdbcType="DECIMAL"  nullValue="0"/>
		<result property="actualReturn.cent" column="ACTUAL_RETURN"  javaType="long" jdbcType="DECIMAL" />
		<result property="actualIntegral" column="ACTUAL_INTEGRAL"  javaType="long" jdbcType="DECIMAL"  nullValue="0"/>
		<result property="returnFlg" column="RETURN_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="provience" column="PROVIENCE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="city" column="CITY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="district" column="DISTRICT"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="addr" column="ADDR"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisOrderDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisOrderDAO.selectOrdersByStatusAndUserId -->
    <select id="MS-ORDER-SELECT-ORDERS-BY-STATUS-AND-USER-ID" resultMap="RM-ORDER">
        SELECT
		        ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order
			where ORDER_TYPE &lt;&gt; '6'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
            ORDER BY GMT_CREATE DESC
			<isNotEmpty property="startRow">
                limit $startRow$,$pageSize$
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectOrdersByStatusAndUserIdAndShopId -->
    <select id="MS-ORDER-SELECT-ORDERS-BY-STATUS-AND-USER-ID-AND-SHOP-ID" resultMap="RM-ORDER">
        SELECT
		        ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order
			where 1=1
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
                <isNotEmpty property="shopId" prepend="and">
                    SHOP_ID = #shopId#
                </isNotEmpty>
            ORDER BY GMT_CREATE DESC
			<isNotEmpty property="startRow">
                limit $startRow$,$pageSize$
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectTeamGoOrdersByStatusAndUserIdAndShopId -->
    <select id="MS-ORDER-SELECT-TEAM-GO-ORDERS-BY-STATUS-AND-USER-ID-AND-SHOP-ID" resultMap="RM-ORDER">
        SELECT
		        ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order where 1=1
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
                <isNotEmpty property="shopId" prepend="and">
                    SHOP_ID = #shopId#
                </isNotEmpty>
               and  ORDER_TYPE = '2' OR ORDER_TYPE = '3'
                ORDER BY GMT_CREATE DESC
			<isNotEmpty property="startRow">
                limit $startRow$,$pageSize$
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectPartnerRankOrder -->
    <select id="MS-ORDER-SELECT-PARTNER-RANK-ORDER" resultMap="RM-ORDER">
        SELECT
		        ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order where ORDER_TYPE = '6'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                ORDER BY ORDER_NUM 
			<isNotEmpty property="startRow">
                limit $startRow$,$pageSize$
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectPartnerRankOrderCount -->
    <select id="MS-ORDER-SELECT-PARTNER-RANK-ORDER-COUNT" resultClass="int">
        SELECT
		    count(1)
			FROM makeploy_order
			where ORDER_TYPE = '6'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectOrdersCountByStatusAndUserId -->
    <select id="MS-ORDER-SELECT-ORDERS-COUNT-BY-STATUS-AND-USER-ID" resultClass="int">
        SELECT
		    count(1)
			FROM makeploy_order
			where ORDER_TYPE &lt;&gt; '6'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectOrdersCountByStatusAndUserIdAndShopId -->
    <select id="MS-ORDER-SELECT-ORDERS-COUNT-BY-STATUS-AND-USER-ID-AND-SHOP-ID" resultClass="int">
        SELECT
		    count(1)
			FROM makeploy_order
			<dynamic prepend="where">
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
                <isNotEmpty property="shopId" prepend="and">
                    SHOP_ID = #shopId#
                </isNotEmpty>
            </dynamic>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectTeamGoOrdersCountByStatusAndUserIdAndShopId -->
    <select id="MS-ORDER-SELECT-TEAM-GO-ORDERS-COUNT-BY-STATUS-AND-USER-ID-AND-SHOP-ID" resultClass="int">
        SELECT
		    count(1)
			FROM makeploy_order  where ORDER_TYPE = '2' OR ORDER_TYPE = '3'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                 <isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
                </isNotEmpty>
                <isNotEmpty property="productNo" prepend="and">
                    PRODUCT_NO = #productNo#
                </isNotEmpty>
                <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                </isNotEmpty>
                 <isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
                </isNotEmpty>
                <isNotEmpty property="shopId" prepend="and">
                    SHOP_ID = #shopId#
                </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectOrdersByOrderId -->
    <select id="MS-ORDER-SELECT-ORDERS-BY-ORDER-ID" resultMap="RM-ORDER">
        SELECT
			*
			FROM makeploy_order
			WHERE 
			<isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
            </isNotEmpty>
            <isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
            </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateOrderUserId -->
    <update id="MS-ORDER-UPDATE-ORDER-USER-ID">
    <![CDATA[
        update makeploy_order set USER_ID=#userId#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.updateOrderStatusByOrderId -->
    <update id="MS-ORDER-UPDATE-ORDER-STATUS-BY-ORDER-ID">
    <![CDATA[
        update makeploy_order set ORDER_STATUS=#orderStatus#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.updateDelFlagByOrderId -->
    <update id="MS-ORDER-UPDATE-DEL-FLAG-BY-ORDER-ID">
    <![CDATA[
        update makeploy_order set DELFLAG=#delflag#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.updateOrderStatusAndOrderSendGoodsByOrderId -->
    <update id="MS-ORDER-UPDATE-ORDER-STATUS-AND-ORDER-SEND-GOODS-BY-ORDER-ID">
    <![CDATA[
        update makeploy_order set ORDER_STATUS=#orderStatus#, SEND_GOODS=#sendGoods#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.addTransportNoByOrderId -->
    <update id="MS-ORDER-ADD-TRANSPORT-NO-BY-ORDER-ID">
    <![CDATA[
        update makeploy_order set TRANSPORT_NO=#transportNo#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.selectOrderByProductNO -->
    <select id="MS-ORDER-SELECT-ORDER-BY-PRODUCT-NO" resultClass="com.onway.makeploy.common.dal.dataobject.ProductShow">
        select
    			 o.USER_ID userId,
    		     o.ORDER_ID orderId,
	    		 o.ORDER_PRICE orderPrice,
	    		 o.PRODUCT_COUNT ProductCount,
	    		 o.LUGGAGE luggage,
	    		 o.SEND_GOODS sendGoods,
	    		 o.PAY_STATUS payStatus,
	    		 o.ORDER_STATUS orderStatus,
	    		 o.PRODUCT_NO productNo,
	    		 p.PRODUCT_NAME productName,
	    		 p.PRICE price,
	    		 p.SHOP_ID shopId,
	    		 p.PRODUCT_URL productImg
    		 	 from
    		 	 makeploy_order o,makeploy_product p where
    		 	 o.PRODUCT_NO = p.PRODUCT_NO 
    		 	 <isNotEmpty property="userId" prepend="and">
                    o.USER_ID = #userId#
               	 </isNotEmpty>
               	  <isNotEmpty property="delflag" prepend="and">
                    o.DELFLAG = #delflag#
               	 </isNotEmpty>
    		 	  <isNotEmpty property="product" prepend="and">
                    o.PRODUCT_NO = #product#
               	 </isNotEmpty>
                <isNotEmpty property="sendGoods" prepend="and">
                    o.PRODUCT_NAME = #sendGoods#
                </isNotEmpty>
                 <isNotEmpty property="payStatus" prepend="and">
                    o.PAY_STATUS = #payStatus#
                </isNotEmpty>
                 ORDER BY o.CREATER limit #offset#,#limit#
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectorderCountByProductNO -->
    <select id="MS-ORDER-SELECTORDER-COUNT-BY-PRODUCT-NO" resultClass="long">
        select count(1)  from makeploy_order o,makeploy_product p 
    			where
    		 	 o.PRODUCT_NO = p.PRODUCT_NO 
    		 	  <isNotEmpty property="userId" prepend="and">
                    o.USER_ID = #userId#
               	  </isNotEmpty>
               	 
               	  <isNotEmpty property="delflag" prepend="and">
                    o.DELFLAG = #delflag#
               	  </isNotEmpty>
               	 
    		 	  <isNotEmpty property="product" prepend="and">
                    o.PRODUCT_NO = #product#
                  </isNotEmpty>
                
                  <isNotEmpty property="sendGoods" prepend="and">
                    o.PRODUCT_NAME = #sendGoods#
                  </isNotEmpty>
                
                  <isNotEmpty property="payStatus" prepend="and">
                    o.PAY_STATUS = #payStatus#
                  </isNotEmpty>
                 ORDER BY o.CREATER
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectOrderAllByOrderId -->
    <select id="MS-ORDER-SELECT-ORDER-ALL-BY-ORDER-ID" resultClass="com.onway.makeploy.common.dal.dataobject.ProductShow">
        select
	    			 o.USER_ID userId,
	    		     o.ORDER_ID orderId,
		    		 o.ORDER_PRICE orderPrice,
		    		 o.PRODUCT_COUNT ProductCount,
		    		 o.LUGGAGE luggage,
		    		 o.SEND_GOODS sendGoods,
		    		 o.PAY_STATUS payStatus,
		    		 o.ORDER_STATUS orderStatus,
		    		 o.PRODUCT_NO productNo,
		    		 o.GMT_CREATE gmtcreate,
		    		 o.GMT_MODIFIED gmtModified,
		    		 p.PRODUCT_NAME productName,
		    		 p.PRICE price,
		    		 p.SHOP_ID shopId,
		    		 p.PRODUCT_URL productImg
	    		 	 from
	    		 	 makeploy_order o,makeploy_product p where
	    		 	 o.PRODUCT_NO = p.PRODUCT_NO  and o.ORDER_ID = #orderId# and o.DELFLAG = #delflag#
    </select>

    <!-- mapped statement for IbatisOrderDAO.creatPartnerOrder -->
    <insert id="MS-ORDER-CREAT-PARTNER-ORDER">
    <![CDATA[
        insert into makeploy_order(ID,USER_ID,USER_NAME,ADDRESS_NO,ORDER_NO,ORDER_ID,ORDER_NUM,CELL,PAY_NO,PARFLAG,TRANSPORT_NO,PRODUCT_NO,EACHPRO_COUNT,PRODUCT_COUNT,EACHPRO_PRICE,POINT,SHOP_ID,ORDER_PRICE,PAY_STATUS,SEND_GOODS,PAY_TIME,PAY_WAY,ORDER_TYPE,ORDER_STATUS,LUGGAGE,DELFLAG,EXPECTED_RETURN,EXPECTED_INTEGRAL,ACTUAL_RETURN,ACTUAL_INTEGRAL,RETURN_FLG,PROVIENCE,CITY,DISTRICT,ADDR,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#id#, #userId#, #userName#, #addressNo#, #orderNo#, #orderId#, #orderNum#, #cell#, #payNo#, #parflag#, #transportNo#, #productNo#, #eachproCount#, #productCount#, #eachproPrice.cent#, #point.cent#, #shopId#, #orderPrice.cent#, 3, 4, CURRENT_TIMESTAMP, #payWay#, 6, 0, #luggage.cent#, 0, #expectedReturn.cent#, #expectedIntegral#, #actualReturn.cent#, #actualIntegral#, #returnFlg#, #provience#, #city#, #district#, #addr#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisOrderDAO.selectByShopID -->
    <select id="MS-ORDER-SELECT-BY-SHOP-ID" resultMap="RM-ORDER">
        select *
				from makeploy_order
				where SHOP_ID=#shopId#
    		 	<isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
               	  </isNotEmpty>
               	<isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                  </isNotEmpty>
                
                  <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                  </isNotEmpty>
                 ORDER BY CREATER
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectCountByShopID -->
    <select id="MS-ORDER-SELECT-COUNT-BY-SHOP-ID" resultClass="int">
        select count(1)
				from makeploy_order
				where SHOP_ID=#shopId# and ORDER_TYPE &lt;&gt; 4
    		 	<isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
               	  </isNotEmpty>
               	<isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                  </isNotEmpty>
                
                  <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                  </isNotEmpty>
                  <isNotEmpty property="orderStatus" prepend="and">
                    ORDER_STATUS = #orderStatus#
                  </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectByShopIDSearchBox -->
    <select id="MS-ORDER-SELECT-BY-SHOP-ID-SEARCH-BOX" resultClass="com.onway.makeploy.common.dal.dataobject.OrderInfo">
        SELECT 
				a.USER_NAME AS userName,
				b.NICK_NAME AS nickName,
				a.CELL AS cell,
				a.ORDER_ID AS orderId,
				a.ORDER_NO AS orderNo,
				a.TRANSPORT_NO AS transportNo,
				a.PARFLAG as parflag,
				a.SHOP_ID as shopId,
				a.ORDER_TYPE as orderType,
				a.PROVIENCE AS provience,
				a.CITY AS city,
				a.DISTRICT AS district,
				a.ADDR AS addr,
				a.PRODUCT_NO AS productNo,
				d.PRODUCT_NAME AS productName,
				e.CHILDREN_NAME AS productSizeType,
				a.EACHPRO_COUNT AS eachproCount,
				a.PRODUCT_COUNT AS productCount,
				a.EACHPRO_PRICE AS eachproPrice,
				a.ORDER_PRICE AS orderPrice,
				a.PAY_STATUS AS payStatus,
				a.SEND_GOODS AS sendGoods,
				a.PAY_TIME AS payTime,
				a.PAY_WAY AS payWay,
				a.ORDER_STATUS AS orderStatus,
				a.LUGGAGE AS luggage,
				a.DELFLAG AS delflag,
				a.EXPECTED_RETURN AS expectedReturn,
				a.EXPECTED_INTEGRAL AS expectedIntegral,
				a.GMT_CREATE AS gmtCreat,
				a.MEMO AS memo
				FROM
				makeploy_order AS a
				LEFT JOIN makeploy_user AS b ON a.USER_ID = b.USER_ID
				LEFT JOIN makeploy_address AS c ON a.ADDRESS_NO = c.ADDRESS_NO
				LEFT JOIN makeploy_product AS d ON a.PRODUCT_NO=d.PRODUCT_NO AND a.SHOP_ID=d.SHOP_ID
				LEFT JOIN makeploy_product_parameters AS e ON a.PRODUCT_NO=e.PRODUCT_NO and a.SHOP_ID=e.SHOP_ID and e.PARFLAG=a.PARFLAG
				where a.ORDER_TYPE &lt;&gt; 4
				<isNotEmpty property="shopId" prepend="and">
                   a.SHOP_ID=#shopId#
               	  </isNotEmpty>
               	  <isNotEmpty property="orderId" prepend="and">
                    a.ORDER_ID = #orderId#
               	  </isNotEmpty>
    		 	<isNotEmpty property="delflag" prepend="and">
                    a.DELFLAG = #delflag#
               	  </isNotEmpty>
               	<isNotEmpty property="sendGoods" prepend="and">
                    a.SEND_GOODS = #sendGoods#
                  </isNotEmpty>
                
                  <isNotEmpty property="payStatus" prepend="and">
                    a.PAY_STATUS = #payStatus#
                  </isNotEmpty>
                  <isNotEmpty property="orderStatus" prepend="and">
                    a.ORDER_STATUS = #orderStatus#
                  </isNotEmpty>
                   <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						a.GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						a.GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
                 ORDER BY a.GMT_CREATE desc 
                 
                limit #startRow#,#pageSize#
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectCountByShopIDSearchBox -->
    <select id="MS-ORDER-SELECT-COUNT-BY-SHOP-ID-SEARCH-BOX" resultClass="int">
        select count(1)
				from makeploy_order
				where SHOP_ID=#shopId# and ORDER_TYPE &lt;&gt; 4
				<isNotEmpty property="orderId" prepend="and">
                    ORDER_ID = #orderId#
               	  </isNotEmpty>
    		 	<isNotEmpty property="delflag" prepend="and">
                    DELFLAG = #delflag#
               	  </isNotEmpty>
               	<isNotEmpty property="sendGoods" prepend="and">
                    SEND_GOODS = #sendGoods#
                  </isNotEmpty>
                
                  <isNotEmpty property="payStatus" prepend="and">
                    PAY_STATUS = #payStatus#
                  </isNotEmpty>
                  
                  <isNotEmpty property="orderStatus" prepend="and">
                    ORDER_STATUS = #orderStatus#
                  </isNotEmpty>
                   <isNotNull prepend="and" property="startDate" >
          			<![CDATA[
						GMT_CREATE >= #startDate#
					]]>
 			</isNotNull>
            <isNotNull prepend="and" property="endDate" >
          			<![CDATA[
						GMT_CREATE <= #endDate#
					]]>
 			</isNotNull>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectIncome -->
    <select id="MS-ORDER-SELECT-INCOME" resultMap="RM-ORDER">
        SELECT
                ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
				FROM makeploy_order 
				WHERE ORDER_STATUS='0' and SEND_GOODS &lt;&gt; '3'
				<isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
				</isNotEmpty>
				<isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			    </isNotEmpty>
	            <isNotEmpty property="start" prepend="and">
	            <![CDATA[
	            	 PAY_TIME >#start# 
	            ]]>  
	             </isNotEmpty>
	             <isNotEmpty property="end" prepend="and">
	             <![CDATA[
	            	 PAY_TIME <=#end#   
	             ]]>
	             </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectSuccees -->
    <select id="MS-ORDER-SELECT-SUCCEES" resultMap="RM-ORDER">
        SELECT
			*
			FROM
			makeploy_order
			where
			PAY_STATUS='3' and SEND_GOODS='4'
			and ORDER_TYPE='1' and ORDER_STATUS='0' and
			RETURN_FLG='0'
			<isNotNull property="startRow">
                limit $startRow$,$pageSize$
            </isNotNull>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectSucceesCount -->
    <select id="MS-ORDER-SELECT-SUCCEES-COUNT" resultClass="int">
    <![CDATA[
        select count(1) from makeploy_order where ((PAY_STATUS = '3') AND (SEND_GOODS = '4') AND (ORDER_TYPE = '1') AND (ORDER_STATUS = '0') AND (RETURN_FLG = '0'))
    ]]>
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateReturn -->
    <update id="MS-ORDER-UPDATE-RETURN">
    <![CDATA[
        update makeploy_order set ACTUAL_RETURN=#actualReturn.cent#, ACTUAL_INTEGRAL=#actualIntegral#, RETURN_FLG=#returnFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((ORDER_ID = #orderId#) AND (ORDER_NO = #orderNo#))
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.partnerOrderByUserId -->
    <select id="MS-ORDER-PARTNER-ORDER-BY-USER-ID" resultMap="RM-ORDER">
    <![CDATA[
        select * from makeploy_order where ((ORDER_TYPE = 4) AND (USER_ID = #value#))
    ]]>
    </select>

    <!-- mapped statement for IbatisOrderDAO.updateInfoBySendsGoods -->
    <update id="MS-ORDER-UPDATE-INFO-BY-SENDS-GOODS">
    <![CDATA[
        update makeploy_order set USER_NAME=#userName#, CELL=#cell#, PROVIENCE=#provience#, CITY=#city#, DISTRICT=#district#, ADDR=#addr#, ORDER_PRICE=#orderPrice.cent#, LUGGAGE=#luggage.cent#, GMT_MODIFIED=CURRENT_TIMESTAMP where ((ORDER_ID = #orderId#) AND (DELFLAG = '0'))
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.selectConfirm -->
    <select id="MS-ORDER-SELECT-CONFIRM" resultMap="RM-ORDER">
        SELECT
			*
			FROM
			makeploy_order
			where SEND_GOODS='2' 
			and #weekAgo# > GMT_MODIFIED
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectCancle -->
    <select id="MS-ORDER-SELECT-CANCLE" resultMap="RM-ORDER">
        SELECT
			*
			FROM
			makeploy_order
			where PAY_STATUS='1' AND DELFLAG = '0'
			and  #minuteAgo# > GMT_MODIFIED  and ORDER_STATUS = '3' OR ORDER_STATUS = '1'
    </select>

    <!-- mapped statement for IbatisOrderDAO.cancleOrder -->
    <update id="MS-ORDER-CANCLE-ORDER">
    <![CDATA[
        update makeploy_order set ORDER_STATUS=#orderStatus# where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.selectMounthOrder -->
    <select id="MS-ORDER-SELECT-MOUNTH-ORDER" resultMap="RM-ORDER">
        select * from makeploy_order where DATE_FORMAT(PAY_TIME,'%Y-%m')=DATE_FORMAT(NOW(),'%Y-%m') and ORDER_STATUS='0' 
		    and SEND_GOODS &lt;&gt; '3'
		    <isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
			</isNotEmpty>
			<isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectWeekOrder -->
    <select id="MS-ORDER-SELECT-WEEK-ORDER" resultMap="RM-ORDER">
        select * from makeploy_order where YEARWEEK(DATE_FORMAT(PAY_TIME,'%Y-%m-%d')) = YEARWEEK(NOW()) and ORDER_STATUS='0' 
		    and SEND_GOODS &lt;&gt; '3'
		    <isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
			</isNotEmpty>
			<isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectMounthProductOrder -->
    <select id="MS-ORDER-SELECT-MOUNTH-PRODUCT-ORDER" resultMap="RM-ORDER">
        select * from makeploy_order where DATE_FORMAT(PAY_TIME,'%Y-%m')=DATE_FORMAT(NOW(),'%Y-%m') and ORDER_STATUS='0' 
		    and SEND_GOODS &lt;&gt; '3'
		    <isNotEmpty property="productNo" prepend="and">
					PRODUCT_NO=#productNo#
			</isNotEmpty>
		    <isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
			</isNotEmpty>
			<isNotEmpty property="praflag" prepend="and">
					PARFLAG=#praflag#
			</isNotEmpty>
			<isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectWeekProductOrder -->
    <select id="MS-ORDER-SELECT-WEEK-PRODUCT-ORDER" resultMap="RM-ORDER">
        select * from makeploy_order where YEARWEEK(DATE_FORMAT(PAY_TIME,'%Y-%m-%d')) = YEARWEEK(NOW()) and ORDER_STATUS='0' 
		    and SEND_GOODS &lt;&gt; '3'
		    <isNotEmpty property="productNo" prepend="and">
					PRODUCT_NO=#productNo#
			</isNotEmpty>
		    <isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
			</isNotEmpty>
			<isNotEmpty property="praflag" prepend="and">
					PARFLAG=#praflag#
			</isNotEmpty>
			<isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectProductIncome -->
    <select id="MS-ORDER-SELECT-PRODUCT-INCOME" resultMap="RM-ORDER">
        SELECT
                ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
				FROM makeploy_order 
				WHERE ORDER_STATUS='0' and SEND_GOODS &lt;&gt; '3'
				<isNotEmpty property="productNo" prepend="and">
					PRODUCT_NO=#productNo#
			    </isNotEmpty>
		        <isNotEmpty property="shopId" prepend="and">
					SHOP_ID=#shopId#
			    </isNotEmpty>
			    <isNotEmpty property="praflag" prepend="and">
					PARFLAG=#praflag#
			    </isNotEmpty>
			    <isNotEmpty property="payWay" prepend="and">
					PAY_WAY=#payWay#
			    </isNotEmpty>
	            <isNotEmpty property="start" prepend="and">
	            <![CDATA[
	            	 PAY_TIME >#start# 
	            ]]>  
	             </isNotEmpty>
	             <isNotEmpty property="end" prepend="and">
	             <![CDATA[
	            	 PAY_TIME <=#end#   
	             ]]>
	             </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisOrderDAO.selectLastPartnerOrder -->
    <select id="MS-ORDER-SELECT-LAST-PARTNER-ORDER" resultMap="RM-ORDER">
        SELECT
			    ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order
			WHERE order_type = '6' AND pay_time IS NOT NULL ORDER BY pay_time DESC LIMIT 0,1
    </select>

    <!-- mapped statement for IbatisOrderDAO.insertCreate -->
    <update id="MS-ORDER-INSERT-CREATE">
    <![CDATA[
        update makeploy_order set CREATER=#creater# where (ORDER_ID = #orderId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisOrderDAO.selectBigThan -->
    <select id="MS-ORDER-SELECT-BIG-THAN" resultMap="RM-ORDER">
        SELECT
		        ID,
				USER_ID,
				USER_NAME,
				ADDRESS_NO,
				ORDER_NO,
				ORDER_ID,
				ORDER_NUM,
				CELL,
				PAY_NO,
				PARFLAG,
				TRANSPORT_NO,
				PRODUCT_NO,
				EACHPRO_COUNT,
				PRODUCT_COUNT,
				EACHPRO_PRICE,
				POINT,
				SHOP_ID,
				ORDER_PRICE,
				PAY_STATUS,
				SEND_GOODS,
				PAY_TIME,
				PAY_WAY,
				ORDER_TYPE,
				ORDER_STATUS,
				LUGGAGE,
				DELFLAG,
				EXPECTED_RETURN,
				EXPECTED_INTEGRAL,
				ACTUAL_RETURN,
				ACTUAL_INTEGRAL,
				RETURN_FLG,
				PROVIENCE,
				CITY,
				DISTRICT,
				ADDR,
				CREATER,
				GMT_CREATE,
				MODIFIER,
				GMT_MODIFIED,
				MEMO
			FROM makeploy_order
			where ORDER_TYPE = '6'
            <isNotEmpty property="orderNum" prepend="and">
                    ORDER_NUM >= #orderNum#
            </isNotEmpty>
            ORDER BY ORDER_NUM
    </select>

    <!-- mapped statement for IbatisOrderDAO.changeOrderNum -->
    <update id="MS-ORDER-CHANGE-ORDER-NUM">
    <![CDATA[
        update makeploy_order set ORDER_NUM=#orderNum# where (ORDER_ID = #orderId#)
    ]]>
    </update>

</sqlMap>
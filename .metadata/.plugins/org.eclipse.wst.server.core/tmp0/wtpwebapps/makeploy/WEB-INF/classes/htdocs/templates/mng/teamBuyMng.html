<!DOCTYPE html>
<html lang="en" class="app">
<head>
<meta charset="utf-8" />
<title>后台管理系统-首页</title>
<meta name="description"
	content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="stylesheet" href="css/app.v2.css" type="text/css" />
<!--[if lt IE 9]> <script src="js/ie/html5shiv.js" cache="false"></script> <script src="js/ie/respond.min.js" cache="false"></script> <script src="js/ie/excanvas.js" cache="false"></script> <![endif]-->
<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script type="text/javascript">
function teamBuyEdit(productNo,shopId,flag,rflag,btn){
	var productNo=productNo;
	var flag=flag;
	var shopId=shopId;
	var rflag=rflag;
	var count=btn.getElementsByTagName("input")[0].value;
	var price=btn.getElementsByTagName("input")[1].value;
	if (flag=='2'){
		if(price==""){
			alert("请输入团购价!");
			return false;
		} 
		if(count==""){
			alert("请输入团购需要的人数");
			return false;
		}
	}
 	
	
	var url="teamBuyEdit.do";
	if(flag==1? confirm("是否确该操作？"):confirm("是否确定该操作?")){
	jQuery.ajax({
		 url : url,// 跳转到 action  
		 type : 'post',
		 cache : false,
		 contentType : "application/x-www-form-urlencoded; charset=utf-8",
		 dataType : 'json',
		 data:{"productNo":productNo,"flag":flag,"shopId":shopId,"rflag":rflag,"count":count,"price":price},
		 success : function(jsonResult) {
		 if (jsonResult.bizSucc) {
			alert(jsonResult.information);
		 	window.location.reload(true);
		 } 
		 else{
			 alert(jsonResult.information);
		 }
		 },
		 error : function() {  
		            alert("异常！");  
		     }  
		   });
	}
}
</script>
<style type="text/css">
#hidden_div {
	position: absolute;
	margin-left: 20%;
	width: 700px;
	display: none;
	height: auto;
	/* 	 	width: calc(100% - 100px);
	height:300px;
	margin:50px 20px 50px 16px;
	background: #bcbcbc;
	display:block;  */
}
</style>
<script type="text/javascript">
	function neededPeople(count,no){
		var a=$("#count_"+no).val(count.value);
	}
	function teamPrice(count,no){
		var a=$("#count-"+no).val(count.value);
	}
</script>
</head>
<body>

	<div class="headline">
		<img src="images/icon.png" />
		<h3 style="font-family: 微软雅黑;">后台管理系统</h3>
		<a href="loginMng.html">安全退出</a>
	</div>
	<section class="hbox stretch">
		<!-- .aside -->
		<aside class="bg-dark lter aside-md hidden-print" id="nav">
			<section class="vbox">
				<section class="w-f scrollable">
					<div class="slim-scroll" data-height="auto"
						data-disable-fade-out="true" data-distance="0" data-size="5px"
						data-color="#333333">
						<nav class="nav-primary hidden-xs">
							<ul class="nav">
								<!-- 发布中心：公告、首页图片 -->
								<li class="active"><a href="" class="active"> <i
										class="fa fa-dashboard icon"> <b class="bg-danger"></b>
									</i> <span class="pull-right"> <i
											class="fa fa-angle-down text"></i> <i
											class="fa fa-angle-up text-active"></i>
									</span> <span>发布管理</span>
								</a>
									<ul class="nav lt">
										<li><a href="noticeMng.html"> <i
												class="fa fa-angle-right"></i> <span>首页信息管理</span></a>
											<ul class="nav lt">
												<li><a href="noticeMng.html"> <i>●</i> <span>公告管理</span>
												</a></li>
												<li><a href="bannerMng.html"> <i>●</i><span>图片管理</span>
												</a></li>
											</ul></li>
										<li class="active"><a href="noticeMng.html"> <i
												class="fa fa-angle-right"></i> <span>商品活动管理</span></a>
											<ul class="nav lt">
												<li><a href="recMng.html"> <i>●</i><span>首页推荐</span>
												</a></li>
												<li><a href="newproMng.html"> <i>●</i><span>新品专区</span>
												</a></li>
												<li class="active"><a href="teamBuyMng.html"> <i>●</i>
														<span>团购专区</span>
												</a></li>
												<li><a href="dividendProMng.html"> <i>●</i> <span>分红商品专区</span>
												</a></li>
												<li><a href="defaultProMng.html"> <i>●</i> <span>默认商品</span>
												</a></li>
											</ul></li>
									</ul></li>
								<!-- 手续费管理 -->
								#if($!checkOperative == '1')
								<li style="display: none;"><a href="counterFee.html"> <i
										class="fa fa-jpy icon"> <b class="bg-info"></b>
									</i> <span>手续费管理</span>
								</a></li>
								#else
								<li><a href="counterFee.html"> <i
										class="fa fa-jpy icon"> <b class="bg-info"></b>
									</i> <span>手续费管理</span>
								</a></li>
								#end
								<!-- 审核中心-->
								<li><a href=""> <i class="fa fa-columns icon"> <b
											class="bg-warning"></b>
									</i> <span class="pull-right"> <i
											class="fa fa-angle-down text"></i> <i
											class="fa fa-angle-up text-active"></i>
									</span> <span>审核中心</span>
								</a>
									<ul class="nav lt">
										<li><a href="shopCheckMng.html"> <i
												class="fa fa-angle-right"></i> <span>店铺审核</span>
										</a></li>
										<li><a href="productCheckMng.html"> <i
												class="fa fa-angle-right"></i> <span>商品审核</span>
										</a></li>
			
									</ul></li>
								<!--充值中心 -->
								#if($!checkOperative == '1')
								<li style="display: none;"><a href="recharge.html"> <i class="fa fa-jpy icon">
											<b class="bg-info"></b>
									</i> <span>充值中心</span>
								</a></li>
								#else
								<li><a href="recharge.html"> <i class="fa fa-jpy icon">
											<b class="bg-info"></b>
									</i> <span>充值中心</span>
								</a></li>
								#end
								<!-- 提现审核 -->
								#if($!checkOperative == '1')
								<li style="display: none;"><a href="withdrawMng.html"> <i
										class="fa fa-jpy icon"> <b class="bg-info"></b>
									</i> <span>提现审核</span>
								</a></li>
								#else
								<li><a href="withdrawMng.html"> <i
										class="fa fa-jpy icon"> <b class="bg-info"></b>
									</i> <span>提现审核</span>
								</a></li>
								#end
								<!-- 商品分类样式管理 -->
								<li><a href=""> <i class="fa fa-columns icon"> <b
											class="bg-warning"></b>
									</i> <span class="pull-right"> <i
											class="fa fa-angle-down text"></i> <i
											class="fa fa-angle-up text-active"></i>
									</span> <span>商品分类样式管理</span>
								</a>
									<ul class="nav lt">
										<li><a href="productTypeMng.html"> <i
												class="fa fa-angle-right"></i> <span>管理分类</span>
										</a></li>
										<li><a href="productParameterMng.html"> <i
												class="fa fa-angle-right"></i> <span>管理样式</span>
										</a></li>

									</ul></li>
								<!-- 信息查询 -->
								<li><a href=""> <i class="fa fa-file-text icon"> <b
											class="bg-primary"></b>
									</i> <span class="pull-right"> <i
											class="fa fa-angle-down text"></i> <i
											class="fa fa-angle-up text-active"></i>
									</span> <span>信息查询</span>
								</a>
									<ul class="nav lt">
										<li><a href="userInfoMng.html"> <i
												class="fa fa-angle-right"></i><span>用户信息查询</span>
										</a></li>
										<li><a href="shopInfoMng.html"> <i
												class="fa fa-angle-right"></i> <span>店铺信息查询</span>
										</a></li>
		
										<li><a href="orderMng.html"> <i
												class="fa fa-angle-right"></i> <span>订单信息查询</span>
										</a></li>
										<li><a href="partnerMng.html"> <i
												class="fa fa-angle-right"></i><span>玫发现商品查询</span>
										</a></li>
										<li><a href="borrowMng.html"> <i
												class="fa fa-angle-right"></i><span>我要借款</span>
										</a></li>
									</ul></li>
								<!-- 意见管理 -->
								<li><a href="optionMng.html"> <i
										class="fa fa-envelope-o icon"> <b class="bg-primary dker"></b>
									</i> <span>意见管理</span>
								</a></li>
							</ul>
						</nav>
					</div>
				</section>
			</section>
		</aside>
		<!-- 主体内容 -->
		<section id="content">
			<section class="vbox">
				<section class="scrollable padder">
					<!-- 弹出层 -->
					<section id="hidden_div"
						class="panel panel-default bg-white m-t-lg">
						<header class="panel-heading text-center">
							<strong>公告发布</strong>
						</header>

						<div class="form-group" style="margin: 10px 30px 0px 30px">
							<label class="control-label">标题</label> <input type="text"
								class="form-control input-lg" name="title" id="title">
						</div>
						<div class="form-group" style="margin: 10px 30px 0px 30px">
							<label class="control-label">公告内容</label>
							<textarea name="noticeinfo" id="noticeinfo" style="height: 400px"
								class="form-control input-lg"></textarea>
						</div>
						<button class="btn btn-primary"
							style="margin-left: 15%; width: 70px;" id="off">取消</button>
						<button onclick="addNotice();" class="btn btn-primary"
							style="margin-left: 45%; width: 70px;">确认</button>

					</section>
					<!-- ---- -->
					<ul class="breadcrumb no-border no-radius b-b b-light pull-in">
						<li><i class="fa fa-home"></i>&nbsp;发布管理</li>
						<li>商品活动管理</li>
						<li>团购商品管理</li>
					</ul>
					<!-- 搜索框 -->
					<div class="panel-body" style="padding-bottom: 0px;">
						<form class="form-horizontal" id="formName"
							action="selectTeamBuy.do" name="formName" method="post">
							<input type="hidden" name="currentPage" id="currentPage"
								value="$!formName.currentPage"> <input type="hidden"
								name="pageSize" id="pageSize" value="$!formName.pageSize">
							<div class="form-group">
								<div class="col-sm-11">
									<div class="row">

										<label class="col-sm-2 control-label"
											style="width: 70px; padding-left: 0px; padding-right: 0px">商铺编号：</label>
										<div class="col-sm-2">
											<input type="text" name="shopId" value=""
												class="form-control">
										</div>
										<label class="col-sm-2 control-label"
											style="width: 70px; padding-left: 0px; padding-right: 0px">商品编号：</label>
										<div class="col-sm-2">
											<input type="text" name="productNo" value=""
												class="form-control">
										</div>
										<label class="col-sm-2 control-label"
											style="width: 70px; padding-left: 0px; padding-right: 0px">商品名称：</label>
										<div class="col-sm-2">
											<input type="text" name="proName" value=""
												class="form-control">
										</div>
										<label class="col-sm-2 control-label"
											style="width: auto; padding-left: 0px; padding-right: 0px">查看已在团购的商品：</label>
										<input name="selectedNew" value="1" type="radio" #if($flag==
											'1'||$flag!='0' ) checked="" #end><label>是</label> <input
											name="selectedNew" value="0" type="radio" #if($flag==
											'0') checked="" #end><label>否</label> <input
											type="submit" id="btnTransfer" value=" 搜索 "
											class="btn btn-primary" />
									</div>
								</div>
							</div>
						</form>
					</div>
					<!--  列表主体 -->
					<section class="panel panel-default">
						<header class="panel-heading">
							<span style="font-family: 微软雅黑;">商品列表</span>&nbsp;
							<!-- <a id="addNotice" 
								style="font-family: 微软雅黑; border: solid 1px; border-radius: 2px; padding: 2px; border-color: darkgrey; color: grey">
								<i class="fa fa-plus text">&nbsp;新增推荐商品</i>
							</a> -->

						</header>
						<!-- 搜索商品 -->
						<div class="table-responsive">
							<table id="announcement"
								class="table table-striped datagrid m-b-sm"
								style="text-align: center">
								<thead>
									<tr>
										<!-- <th>ID</th> -->
										<th style="width: 10%">商铺编号</th>
										<th style="width: 10%">商品编号</th>
										<th style="width: 15%">商品名称</th>
										<th style="width: 10%">商品图片</th>
										<th style="width: 10%">商品原价</th>
										<th style="width: 10%">团购价</th>
										<th>团购需要人数</th>
										<th style="text-align: center">编辑</th>
									</tr>
								</thead>
								#if($flag=='1'&&$haveTeamRec=='1') #foreach($!teamBuyinforec in
								$!teamBuyinforec)
								<tr>
									<td>$!teamBuyinforec.shopId</td>
									<td>$!teamBuyinforec.productNo</td>
									<td>$!teamBuyinforec.productName</td>
									<td><img
										style="margin-left: 10%; margin-top: 0px; width: 70px; height: 70px"
										src="$!teamBuyinforec.productUrl" alt=""></td>
									<td>$!teamBuyinforec.oldPrice元</td>
									<td>$!teamBuyinforec.price元</td>
									<td style="text-align: center">$!teamBuyinforec.needPeople</td>
									<td style="width: 20%; padding: 20px 20px">
										<button class="btn   btn-danger"
											style="width: auto; padding: 5px 6px; margin-left: 15px;"
											disabled="disabled" type="button"
											onclick="teamBuyEdit($!teamBuyinforec.productNo,$!teamBuyinforec.shopId,'0','2',0)"
											value="团购首推" name="a_up">
											团购首推 <input type="hidden" id="count_$state" value="" />
										</button>
										<button class="btn   btn-default"
											style="width: auto; padding: 5px 6px; marigin-left: 20px;"
											type="button"
											onclick="teamBuyEdit($!teamBuyinforec.productNo,$!teamBuyinforec.shopId,'0','1',this)"
											value="撤消" name="a_delete">
											撤消首推 <input type="hidden" id="count_$state" value="" /> <input
												type="hidden" id="count-$state" value="" />
										</button>
									</td> #end #end #set($state=1) #foreach($teamBuyinfo in
									$teamBuyinfo)
								<tr>
									<td>$!teamBuyinfo.shopId</td>
									<td>$!teamBuyinfo.productNo</td>
									<td>$!teamBuyinfo.productName</td>
									<td><img
										style="margin-left: 10%; margin-top: 0px; width: 70px; height: 70px"
										src="$!teamBuyinfo.productUrl" alt="应该有张图！"></td>
									<td>$!teamBuyinfo.oldPrice元</td> #if($flag=='0')
									<td><input type="text" value="" style="width: 70px"
										onchange="teamPrice(this,$state)">元</td>
									<td style="text-align: center"><input type="text" value=""
										style="width: 70px" onchange="neededPeople(this,$state)">人</td>
									#elseif($flag=='1')
									<td style="text-align: center">$!teamBuyinfo.price元</td>
									<td style="text-align: center">$!teamBuyinfo.needPeople人</td>
									#end
									<td style="width: 20%; padding: 20px 20px; text-align: center">
										#if($flag=='1')
										<button class="btn   btn-danger"
											style="width: auto; padding: 5px 6px; margin-left: 20px"
											type="button"
											onclick="teamBuyEdit($!teamBuyinfo.productNo,$!teamBuyinfo.shopId,'1','2',this)"
											value="团购首推" name="a_up">
											团购首推 <input type="hidden" id="count_$state" value="" /> <input
												type="hidden" id="count-$state" value="" />
										</button>
										<button class="btn   btn-default"
											style="width: auto; padding: 5px 6px; marigin-left: 20px;"
											type="button"
											onclick="teamBuyEdit($!teamBuyinfo.productNo,$!teamBuyinfo.shopId,'1','0',this)"
											value="撤消" name="a_delete">
											撤消团购 <input type="hidden" id="count_$state" value="" /> <input
												type="hidden" id="count-$state" value="" />
										</button> #elseif($flag=='0')
										<button class="btn   btn-danger"
											style="width: auto; padding: 5px 6px; margin-left: 20px"
											type="button"
											onclick="teamBuyEdit($!teamBuyinfo.productNo,$!teamBuyinfo.shopId,'2','0',this)"
											value="加入团购" name="a_up">
											加入团购
											<!-- 										<div style="display:none" id="count_$state"></div> -->
											<input type="hidden" id="count_$state" value="" /> <input
												type="hidden" id="count-$state" value="" />
										</button>

									</td> #end #set($state=$state+1) #end
							</table>
						</div>
					</section>
					<!-- ---列表主体--- -->
					<div class="fn-mt7">#set ($formName = "formName")
						#parse('/mng/page.html')</div>
					<div style="height: 200px"></div>
				</section>
			</section>
			<a href="#" class="hide nav-off-screen-block"
				data-toggle="class:nav-off-screen" data-target="#nav"></a>
		</section>
		<!--  -----主体内容------ -->
	</section>

	<script src="js/app.v2.js"></script>
	<script type="text/javascript">
$("#addNotice").click(function(){  
		$("#hidden_div").fadeToggle();
		return false;
});  
$("#off").click(function(){  
   $("#hidden_div").fadeToggle();  
   return false;
});
</script>
</body>
</html>
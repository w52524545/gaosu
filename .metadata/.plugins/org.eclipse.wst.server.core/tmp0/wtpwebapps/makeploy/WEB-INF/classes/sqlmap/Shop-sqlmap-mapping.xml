<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table makeploy_shop -->
    <resultMap id="RM-SHOP" class="com.onway.makeploy.common.dal.dataobject.ShopDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="shopId" column="SHOP_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="shopName" column="SHOP_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="cell" column="CELL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="shopStar" column="SHOP_STAR"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="industry" column="INDUSTRY"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="shopDec" column="SHOP_DEC"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="shopAddr" column="SHOP_ADDR"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="unionFlg" column="UNION_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="loactionX" column="LOACTION_X"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="loactionY" column="LOACTION_Y"  javaType="double" jdbcType="DOUBLE"  nullValue="0"/>
		<result property="shopUrl" column="SHOP_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="sellCount" column="SELL_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="attentionCount" column="ATTENTION_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="collectCount" column="COLLECT_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="qrUrl" column="QR_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="shopUp" column="SHOP_UP"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="delFlag" column="DEL_FLAG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisShopDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisShopDAO.selectShopInfoByUserId -->
    <select id="MS-SHOP-SELECT-SHOP-INFO-BY-USER-ID" resultMap="RM-SHOP">
        SELECT
			*
			from makeploy_shop
			WHERE USER_ID = #userId#
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopCountByUserId -->
    <select id="MS-SHOP-SELECT-SHOP-COUNT-BY-USER-ID" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_shop
			WHERE USER_ID = #userId#
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopInfoByShopId -->
    <select id="MS-SHOP-SELECT-SHOP-INFO-BY-SHOP-ID" resultMap="RM-SHOP">
        SELECT
			ID,
			SHOP_ID,
			USER_ID,
			SHOP_NAME,
			SHOP_DEC,
			CELL,
			SHOP_STAR,
			SHOP_ADDR,
			INDUSTRY,
			LOACTION_X,
			LOACTION_Y,
			SHOP_URL,
			SELL_COUNT,
			ATTENTION_COUNT,
			COLLECT_COUNT,
			QR_URL,
			UNION_FLG,
			SHOP_UP,
			DEL_FLAG,
			CREATER,
			GMT_CREATE,
			MODIFIER,
			GMT_MODIFIED,
			MEMO
			FROM makeploy_shop
			WHERE SHOP_ID = #shopId#
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopInfoByShopCell -->
    <select id="MS-SHOP-SELECT-SHOP-INFO-BY-SHOP-CELL" resultMap="RM-SHOP">
        SELECT
			ID,
			SHOP_ID,
			USER_ID,
			SHOP_NAME,
			SHOP_DEC,
			CELL,
			SHOP_STAR,
			SHOP_ADDR,
			INDUSTRY,
			LOACTION_X,
			LOACTION_Y,
			SHOP_URL,
			SELL_COUNT,
			ATTENTION_COUNT,
			COLLECT_COUNT,
			QR_URL,
			UNION_FLG,
			SHOP_UP,
			DEL_FLAG,
			CREATER,
			GMT_CREATE,
			MODIFIER,
			GMT_MODIFIED,
			MEMO
			FROM makeploy_shop
			WHERE CELL = #cell#
    </select>

    <!-- mapped statement for IbatisShopDAO.updateShopInfo -->
    <update id="MS-SHOP-UPDATE-SHOP-INFO">
    <![CDATA[
        update makeploy_shop set SHOP_NAME=#shopName#, SHOP_DEC=#shopDec#, CELL=#cell#, SHOP_ADDR=#shopAddr#, SHOP_URL=#shopUrl#, INDUSTRY=#industry#, LOACTION_X=#loactionX#, LOACTION_Y=#loactionY#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.selectShopByShopId -->
    <select id="MS-SHOP-SELECT-SHOP-BY-SHOP-ID" resultMap="RM-SHOP">
    <![CDATA[
        select * from makeploy_shop where (SHOP_ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisShopDAO.selectAllShop -->
    <select id="MS-SHOP-SELECT-ALL-SHOP" resultMap="RM-SHOP">
    <![CDATA[
        select * from makeploy_shop
    ]]>
    </select>

    <!-- mapped statement for IbatisShopDAO.selectUnionShopOnHome -->
    <select id="MS-SHOP-SELECT-UNION-SHOP-ON-HOME" resultMap="RM-SHOP">
        SELECT
			ID,
			SHOP_ID,
			USER_ID,
			SHOP_NAME,
			CELL,
			SHOP_STAR,
			SHOP_DEC,
			SHOP_ADDR,
			INDUSTRY,
			LOACTION_X,
			LOACTION_Y,
			SHOP_URL,
			SELL_COUNT,
			ATTENTION_COUNT,
			COLLECT_COUNT,
			QR_URL,
			UNION_FLG,
			SHOP_UP,
			DEL_FLAG,
			CREATER,
			GMT_CREATE,
			MODIFIER,
			GMT_MODIFIED,
			MEMO
			FROM makeploy_shop
			WHERE UNION_FLG = '1' AND DEL_FLAG = '1'
			order by rand() limit 3
    </select>

    <!-- mapped statement for IbatisShopDAO.selectUnionShopCount -->
    <select id="MS-SHOP-SELECT-UNION-SHOP-COUNT" resultClass="int">
        SELECT
			count(1)
			FROM makeploy_shop
			WHERE UNION_FLG = 1
    </select>

    <!-- mapped statement for IbatisShopDAO.selectUnionShop -->
    <select id="MS-SHOP-SELECT-UNION-SHOP" resultMap="RM-SHOP">
        SELECT
		     ID,
		     SHOP_ID,
		     USER_ID,
		     SHOP_NAME,
		     CELL,
		     SHOP_STAR,
		     SHOP_DEC,
		     CELL,
		     SHOP_ADDR,
		     INDUSTRY,
		     LOACTION_X,
		     LOACTION_Y,
		     SHOP_URL,
		     SELL_COUNT,
		     ATTENTION_COUNT,
		     COLLECT_COUNT,
		     QR_URL,
		     UNION_FLG,
		     SHOP_UP,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_shop
            WHERE UNION_FLG = 1
            <isNotNull property="startRow">
                limit $startRow$,$pageSize$
            </isNotNull>
    </select>

    <!-- mapped statement for IbatisShopDAO.search -->
    <select id="MS-SHOP-SEARCH" resultMap="RM-SHOP">
        select * from makeploy_shop where SHOP_ID LIKE #shopId#
				<isNotNull property="startRow">
                limit $startRow$,$pageSize$
                </isNotNull>
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopListByUserId -->
    <select id="MS-SHOP-SELECT-SHOP-LIST-BY-USER-ID" resultMap="RM-SHOP">
    <![CDATA[
        select * from makeploy_shop where (USER_ID = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopIdandCellInfo -->
    <select id="MS-SHOP-SELECT-SHOP-IDAND-CELL-INFO" resultMap="RM-SHOP">
        SELECT
		     ID,
		     SHOP_ID,
		     USER_ID,
		     SHOP_NAME,		     
		     SHOP_DEC,
		     CELL,
		     SHOP_STAR,
		     SHOP_ADDR,
		     INDUSTRY,
		     LOACTION_X,
		     LOACTION_Y,
		     SHOP_URL,
		     SELL_COUNT,
		     ATTENTION_COUNT,
		     COLLECT_COUNT,
		     QR_URL,
		     UNION_FLG,
		     SHOP_UP,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_shop WHERE 1=1
				<isNotEmpty property="shopId" prepend="and">
	                SHOP_ID = #shopId#
	            </isNotEmpty>   
	            <isNotEmpty property="cell" prepend="and">
	                CELL = #cell#
	            </isNotEmpty>   
	            limit #offent#,#limit#
    </select>

    <!-- mapped statement for IbatisShopDAO.updateUnion -->
    <update id="MS-SHOP-UPDATE-UNION">
    <![CDATA[
        update makeploy_shop set UNION_FLG=#unionFlg#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.count -->
    <select id="MS-SHOP-COUNT" resultClass="long">
    <![CDATA[
        select count(1) from makeploy_shop
    ]]>
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopInfo -->
    <select id="MS-SHOP-SELECT-SHOP-INFO" resultMap="RM-SHOP">
        select * from  makeploy_shop WHERE UNION_FLG = #unionFlag#
				
				<isNotEmpty property="shopId" prepend="and">
	                    SHOP_ID = #shopId#
	                </isNotEmpty>
	            <isNotEmpty property="userId" prepend="and">
	                    USER_ID = #userId#
	                </isNotEmpty>
	            <isNotEmpty property="industry" prepend="and">
	                    INDUSTRY = #industry#
	                </isNotEmpty>
	                limit #offset#,#limit#
    </select>

    <!-- mapped statement for IbatisShopDAO.selectShopInfoCount -->
    <select id="MS-SHOP-SELECT-SHOP-INFO-COUNT" resultClass="long">
        select count(1) from  makeploy_shop WHERE UNION_FLG = #unionflag#
				
				<isNotEmpty property="shopId" prepend="and">
	                    SHOP_ID = #shopId#
	                </isNotEmpty>
	            <isNotEmpty property="userId" prepend="and">
	                    USER_ID = #userId#
	                </isNotEmpty>
	            <isNotEmpty property="industry" prepend="and">
	                    INDUSTRY = #industry#
	                </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisShopDAO.creatNewShop -->
    <insert id="MS-SHOP-CREAT-NEW-SHOP">
    <![CDATA[
        insert into makeploy_shop(ID,SHOP_ID,USER_ID,UNION_FLG,SHOP_URL,DEL_FLAG,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#id#, #shopId#, #userId#, #unionFlg#, #shopUrl#, #delFlag#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisShopDAO.addCheckedShop -->
    <insert id="MS-SHOP-ADD-CHECKED-SHOP">
    <![CDATA[
        insert into makeploy_shop(SHOP_ID,USER_ID,SHOP_NAME,CELL,SHOP_STAR,SHOP_DEC,SHOP_ADDR,UNION_FLG,DEL_FLAG,INDUSTRY,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#shopId#, #userId#, #shopName#, #cell#, #shopStar#, #shopDec#, #shopAddr#, #unionFlg#, #delFlag#, #industry#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisShopDAO.selectAllShopInfo -->
    <select id="MS-SHOP-SELECT-ALL-SHOP-INFO" resultMap="RM-SHOP">
    <![CDATA[
        select * from makeploy_shop
    ]]>
    </select>

    <!-- mapped statement for IbatisShopDAO.updateShopLngAndLat -->
    <update id="MS-SHOP-UPDATE-SHOP-LNG-AND-LAT">
    <![CDATA[
        update makeploy_shop set LOACTION_X=#loactionX#, LOACTION_Y=#loactionY#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.updateShopLevel -->
    <update id="MS-SHOP-UPDATE-SHOP-LEVEL">
    <![CDATA[
        update makeploy_shop set CREATER=#creater#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.setShopUp -->
    <update id="MS-SHOP-SET-SHOP-UP">
    <![CDATA[
        update makeploy_shop set SHOP_UP=#shopUp#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.changeShopCellCount -->
    <update id="MS-SHOP-CHANGE-SHOP-CELL-COUNT">
    <![CDATA[
        update makeploy_shop set SELL_COUNT=#sellCount#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisShopDAO.changeShopDelFlag -->
    <update id="MS-SHOP-CHANGE-SHOP-DEL-FLAG">
    <![CDATA[
        update makeploy_shop set DEL_FLAG=#delFlag#, GMT_MODIFIED=CURRENT_TIMESTAMP where (SHOP_ID = #shopId#)
    ]]>
    </update>

</sqlMap>
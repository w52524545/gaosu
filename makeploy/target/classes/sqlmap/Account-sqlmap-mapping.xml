<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table makeploy_account -->
    <resultMap id="RM-ACCOUNT" class="com.onway.makeploy.common.dal.dataobject.AccountDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="userId" column="USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="orderNo" column="ORDER_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="accountNo" column="ACCOUNT_NO"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="amount.cent" column="AMOUNT"  javaType="long" jdbcType="DECIMAL" />
		<result property="type" column="TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="subType" column="SUB_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="point" column="POINT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisAccountDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByUserIdAndorderNoOld -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-USER-ID-ANDORDER-NO-OLD" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			<dynamic prepend="where">
                <isNotNull property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotNull>
                <isNotNull property="orderNo" prepend="and">
                    ORDER_NO = #orderNo#
                </isNotNull>
            </dynamic>
    </select>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByUserIdAndorderNo -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-USER-ID-ANDORDER-NO" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			where TYPE='2'
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                <isNotEmpty property="orderNo" prepend="and">
                    ORDER_NO = #orderNo#
                </isNotEmpty>
                order by SUB_TYPE desc
                 limit #offent#,#limit#
    </select>

    <!-- mapped statement for IbatisAccountDAO.selectShopOutMoneyInfo -->
    <select id="MS-ACCOUNT-SELECT-SHOP-OUT-MONEY-INFO" resultMap="RM-ACCOUNT">
        SELECT
			ID,
			USER_ID,
			ORDER_NO,
			ACCOUNT_NO,
			AMOUNT,
			TYPE,
			SUB_TYPE,
			POINT,
			CREATER,
			GMT_CREATE,
			MODIFIER,
			GMT_MODIFIED,
			MEMO
			FROM
			makeploy_account
			WHERE USER_ID = #userId#
			and TYPE = '6'
			order by GMT_MODIFIED DESC
    </select>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByUserId -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-USER-ID" resultMap="RM-ACCOUNT">
        SELECT
			ID,
			USER_ID,
			ORDER_NO,
			ACCOUNT_NO,
			AMOUNT,
			TYPE,
			SUB_TYPE,
			POINT,
			CREATER,
			GMT_CREATE,
			MODIFIER,
			GMT_MODIFIED,
			MEMO
			FROM
			makeploy_account
			WHERE USER_ID = #userId#
    </select>

    <!-- mapped statement for IbatisAccountDAO.updateStatus -->
    <update id="MS-ACCOUNT-UPDATE-STATUS">
    <![CDATA[
        update makeploy_account set SUB_TYPE=#subType# where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisAccountDAO.updateStatusByAccountNo -->
    <update id="MS-ACCOUNT-UPDATE-STATUS-BY-ACCOUNT-NO">
    <![CDATA[
        update makeploy_account set SUB_TYPE=#subType#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ACCOUNT_NO = #accountNo#)
    ]]>
    </update>

    <!-- mapped statement for IbatisAccountDAO.count -->
    <select id="MS-ACCOUNT-COUNT" resultClass="long">
        select count(1) from makeploy_account
    where TYPE='2'
    	<isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
        </isNotEmpty>
        <isNotEmpty property="orderNo" prepend="and">
                    ORDER_NO = #orderNo#
        </isNotEmpty>
    </select>

    <!-- mapped statement for IbatisAccountDAO.countAccountNo -->
    <select id="MS-ACCOUNT-COUNT-ACCOUNT-NO" resultClass="long">
        select count(1) from makeploy_account
    where 1=1 
    	<isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
        </isNotEmpty>
        <isNotEmpty property="accountNo" prepend="and">
                    ACCOUNT_NO = #accountNo#
        </isNotEmpty>
        and TYPE in('2','6','7')
    </select>

    <!-- mapped statement for IbatisAccountDAO.insert -->
    <insert id="MS-ACCOUNT-INSERT">
    <![CDATA[
        insert into makeploy_account(USER_ID,ORDER_NO,ACCOUNT_NO,AMOUNT,TYPE,SUB_TYPE,POINT,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#userId#, #orderNo#, #accountNo#, #amount.cent#, #type#, #subType#, #point#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByUserIdAndAccountNo -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-USER-ID-AND-ACCOUNT-NO" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			where 1=1
                <isNotEmpty property="userId" prepend="and">
                    USER_ID = #userId#
                </isNotEmpty>
                <isNotEmpty property="accountNo" prepend="and">
                    ACCOUNT_NO = #accountNo#
                </isNotEmpty>
             and   TYPE in ('2','6','7')
                order by SUB_TYPE desc ,GMT_CREATE desc
                 limit #offent#,#limit#
    </select>

    <!-- mapped statement for IbatisAccountDAO.outMoney -->
    <insert id="MS-ACCOUNT-OUT-MONEY">
    <![CDATA[
        insert into makeploy_account(ID,USER_ID,ORDER_NO,ACCOUNT_NO,AMOUNT,TYPE,SUB_TYPE,POINT,CREATER,GMT_CREATE,MODIFIER,GMT_MODIFIED,MEMO) values (#id#, #userId#, #orderNo#, #accountNo#, #amount.cent#, #type#, #subType#, #point#, #creater#, CURRENT_TIMESTAMP, #modifier#, CURRENT_TIMESTAMP, #memo#)
    ]]>
	<selectKey resultClass="int" keyProperty="id">
       select last_insert_id() as id
    </selectKey>
    </insert>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByID -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-ID" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			<dynamic prepend="where">
                <isNotNull property="Id" prepend="and">
                    ID = #Id#
                </isNotNull>
            </dynamic>
    </select>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByAccountNo -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-ACCOUNT-NO" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			<dynamic prepend="where">
                <isNotNull property="accountNo" prepend="and">
                    ACCOUNT_NO = #accountNo#
                </isNotNull>
            </dynamic>
    </select>

    <!-- mapped statement for IbatisAccountDAO.selectAccountInfoByType -->
    <select id="MS-ACCOUNT-SELECT-ACCOUNT-INFO-BY-TYPE" resultMap="RM-ACCOUNT">
        SELECT
		     ID,
		     USER_ID,
		     ORDER_NO,
		     ACCOUNT_NO,
		     AMOUNT,
		     TYPE,
		     SUB_TYPE,
		     POINT,
		     CREATER,
		     GMT_CREATE,
		     MODIFIER,
		     GMT_MODIFIED,
		     MEMO
			FROM makeploy_account
			<dynamic prepend="where">
                <isNotNull property="type" prepend="and">
                    TYPE = #type#
                </isNotNull>
            </dynamic>
            order by GMT_CREATE desc
    </select>

</sqlMap>